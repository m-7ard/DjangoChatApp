{% extends "rooms/app.html" %}
{% load static %}

{% block extrahead %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'rooms/channel.css' %}">
{% endblock %}


{% block app__main %}
<div class="container container--fill">
	<div class="container__header">
		{{ channel.name }}
	</div>
	<div class="container__subheader has-shadow">
		<span class="icon icon--small left">
			<i class="material-symbols-outlined">
				first_page
			</i>
		</span>
		<span class="left right">
			{{ channel.description }}
		</span>
		<span class="icon icon--small right">
			<i class="material-symbols-outlined">
				last_page
			</i>
		</span>
	</div>
	<div class="wrapper--remaining-space">
		<ul class="container__content" id="app__messages">
			{% for backlog in backlogs %}
				{% if backlog|classname == 'Message' %}
					{% with backlog as message %}
						{% include "./elements/message.html" with message_pk=message.pk room_pk=room.pk image=message.user.profile.image.url username=message.member.display_name timestamp=message.display_date content=message.content editable=message.user.pk|eq:user.pk member_pk=message.member.pk %}
					{% endwith %}
				{% elif backlog|classname == 'Log' %}
					{% with backlog as log %}
						<li class="log">
							<span class="primary-text primary-text--small offline-color--primary">
								{{ log.trigger_user }}
							</span>
							<span class="secondary-text secondary-text--small offline-color--secondary">
								{{ log.action.display_name }}
							</span>
							{% if log.target_user %}
							<span class="primary-text primary-text--small offline-color--primary">
								{{ log.target_user }}
							</span>
							{% endif %}
							<span class="secondary-text secondary-text--small offline-color--secondary">
								{{ log.display_date }}
							</span>
						</li>
					{% endwith %}
				{% endif %}
			{% endfor %}
		</ul>
	</div>
	<div class="chatbar">
		<span class="chatbar__button">
			<div class="icon icon--small">
				<i class="material-symbols-outlined">
					attach_file
				</i>
			</div>
		</span>
		<span class="wrapper--remaining-space">
			<textarea class="chatbar__input secondary-text secondary-text--large"></textarea>
		</span>
		<span class="chatbar__button tooltip__trigger" data-target=".reactions" data-positioning='{"bottom": "-100%", "right": "0px"}' data-kind="chatbar_reaction">
			<div class="icon icon--small">
				<i class="material-symbols-outlined">
					sentiment_satisfied
				</i>
			</div>
		</span>
	</div>
</div>
{% endblock %}

{% block app__sidebar--primary %}
	{% include "./elements/app__sidebar--primary.html" %}
{% endblock %}

{% block tooltips %}
	{{ block.super }}
	{% include "./elements/reactions.html" %}
{% endblock %}


{% block scripts %}
{{ block.super }}
<script src="{% static 'js/channel.js' %}"></script>
{% endblock %}